# sd-webui-fast-dataset-maker
ä¸€ä¸ªæœ‰è¶£çš„æ‰©å±•ï¼Œæ•´åˆäº† `å›¾åº“`ï¼Œ`ä¸‹è½½`ï¼Œ`å»é‡`ï¼Œ`èšç±»` ï¼Œå¯ä»¥å¿«é€Ÿæœé›†ã€åˆ†ç±»ã€å¤„ç†ä½ çš„å›¾ç‰‡ã€‚

A funny extension that integrates `image-browsing` , `downloader` , `deduplicate` , `cluster` , can quickly collect, classify and process your images.

### Powered by

- [zanllp/sd-webui-infinite-image-browsing](https://github.com/zanllp/sd-webui-infinite-image-browsing)
- [WSH032/Gelbooru-API-Downloader](https://github.com/WSH032/Gelbooru-API-Downloader)
- [WSH032/image-deduplicate-cluster-webui](https://github.com/WSH032/image-deduplicate-cluster-webui)
- [toshiaki1729/dataset-tag-editor-standalone](https://github.com/toshiaki1729/dataset-tag-editor-standalone)

> æˆ‘åªæ˜¯æŠŠå®ƒä»¬æ•´åˆèµ·æ¥ï¼Œå¹¶ç‹¬ç«‹è¿è¡Œ

### Credit
WebUIéƒ¨åˆ†å€Ÿé‰´äº†[AUTOMATIC1111/stable-diffusion-webui](https://github.com/AUTOMATIC1111/stable-diffusion-webui)



## ç°åœ¨æˆ‘ä»¬æœ‰ä»€ä¹ˆï¼Ÿ
### 1. å¼ºå¤§çš„å›¾ç‰‡æµè§ˆå™¨
æ¥è‡ª[zanllp/sd-webui-infinite-image-browsing](https://github.com/zanllp/sd-webui-infinite-image-browsing)
![sd-webui-infinite-image-browsing](https://github.com/WSH032/sd-webui-fast-dataset-maker/assets/126865849/b98a293f-a3a0-4d59-a997-cae86e7f25b4)

### 2. Gelbooruçš„å›¾ç‰‡ä¸‹è½½å™¨
æ¥è‡ª[WSH032/Gelbooru-API-Downloader](https://github.com/WSH032/Gelbooru-API-Downloader)
![Gelbooru-API-Downloader](https://github.com/WSH032/sd-webui-fast-dataset-maker/assets/126865849/03dbd069-336c-40a1-9e14-5143eb915339)

### 3. åŸºäºimagededupï¼Œsklearnï¼ŒWD14æ¨¡å‹çš„å›¾ç‰‡å»é‡ä¸èšç±»
æ¥è‡ª[WSH032/image-deduplicate-cluster-webui](https://github.com/WSH032/image-deduplicate-cluster-webui)
![deduplicate-webui](https://github.com/WSH032/sd-webui-fast-dataset-maker/assets/126865849/dccd5928-cdfc-4d58-b806-edc0ed2df9c9)

**[cluster-webui å±•ç¤º](https://github.com/WSH032/sd-webui-fast-dataset-maker/assets/126865849/c38200fa-78dc-4b91-a006-1784fb7059bb)**

### 4. å¼ºå¤§çš„boorué£æ ¼çš„tagç¼–è¾‘æ’ä»¶
æ¥è‡ª[toshiaki1729/dataset-tag-editor-standalone](https://github.com/toshiaki1729/dataset-tag-editor-standalone)
![dataset-tag-editor-standalone](https://github.com/WSH032/sd-webui-fast-dataset-maker/assets/126865849/6761bbb6-b9bb-4463-a41c-0b0eceb1baab)

**[dataset-tag-editor-standalone å®Œæ•´å±•ç¤º](https://github.com/WSH032/sd-webui-fast-dataset-maker/assets/126865849/919a2d87-d399-41a9-86bf-b8c4e50973b0)**


## ğŸ˜€Development
å¦‚æœä½ è§‰å¾—æ­¤é¡¹ç›®æœ‰ç”¨ğŸ’ªï¼Œå¯ä»¥å» [![GitHub Repo stars](https://img.shields.io/github/stars/WSH032/sd-webui-fast-dataset-maker?style=social)](https://github.com/WSH032/sd-webui-fast-dataset-maker) ç‚¹ä¸€é¢—å°æ˜Ÿæ˜ŸğŸ¤¤ï¼Œéå¸¸æ„Ÿè°¢ä½ â­

é‡åˆ°é—®é¢˜å¯ä»¥åœ¨[Githubä¸Šæissue â“](https://github.com/WSH032/sd-webui-fast-dataset-maker/issues)


## æ›´æ–° Update
éƒ¨ç½²ä½¿ç”¨æ—¶æ›´æ–°æ–¹å¼ï¼š

æœ¬é¡¹ç›®å¸¦æœ‰å­æ¨¡å—ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‹‰å–æ–°çš„æ›´æ–°ï¼Œå¹¶å†æ¬¡é‡å¤ `å®‰è£… Install` ï¼Œä»¥å…æœ‰æ–°çš„ä¾èµ–è¦æ±‚
```shell
git pull --recurse-submodules 
```
å¦‚æœä½ ä¸ä¼šä½¿ç”¨gitå‘½ä»¤ï¼Œå¯ä»¥è¿è¡Œ`update.ps1`å®Œæˆæ›´æ–°

## å®‰è£… Install

### ï¼ˆä¸€ï¼‰Colabä½¿ç”¨
#### æœ¬é¡¹ç›®é“¾æ¥ Fast-Dataset-Maker Colab
| Notebook Name | Description | Link | Old-Version |
| --- | --- | --- | --- |
| [fast_dataset_maker](https://github.com/WSH032/sd-webui-fast-dataset-maker) `NEW` | æ•´åˆäº† `å›¾åº“`ï¼Œ`ä¸‹è½½`ï¼Œ`å»é‡`ï¼Œ`èšç±»` çš„å›¾ç‰‡æ•°æ®é›†WebUI | [![](https://img.shields.io/static/v1?message=Open%20in%20Colab&logo=googlecolab&labelColor=5c5c5c&color=0f80c1&label=%20&style=flat)](https://colab.research.google.com/github/WSH032/sd-webui-fast-dataset-maker/blob/main/fast_dataset_maker.ipynb) |

---

#### å‹æƒ…é“¾æ¥ SD-Lora-Training Colab
| Notebook Name | Description | Link | Old-Version |
| --- | --- | --- | --- |
| [Colab_Lora_train](https://github.com/WSH032/lora-scripts/) | åŸºäº[Akegarasu/lora-scripts](https://github.com/Akegarasu/lora-scripts)çš„å®šåˆ¶åŒ–Colab notebook | [![](https://img.shields.io/static/v1?message=Open%20in%20Colab&logo=googlecolab&labelColor=5c5c5c&color=0f80c1&label=%20&style=flat)](https://colab.research.google.com/github/WSH032/lora-scripts/blob/main/Colab_Lora_train.ipynb) | [![](https://img.shields.io/static/v1?message=Older%20Version&logo=googlecolab&labelColor=5c5c5c&color=e74c3c&label=%20&style=flat)](https://colab.research.google.com/drive/1_f0qJdM43BSssNJWtgjIlk9DkIzLPadx) |
| [kohya_train_webui](https://github.com/WSH032/kohya-config-webui) `NEW` | åŸºäº[WSH032/kohya-config-webui](https://github.com/WSH032/kohya-config-webui)çš„WebUIç‰ˆColab notebook | [![](https://img.shields.io/static/v1?message=Open%20in%20Colab&logo=googlecolab&labelColor=5c5c5c&color=0f80c1&label=%20&style=flat)](https://colab.research.google.com/github/WSH032/kohya-config-webui/blob/main/kohya_train_webui.ipynb) |

### ï¼ˆäºŒï¼‰éƒ¨ç½²ä½¿ç”¨
**è¯·å°½é‡ä½¿ç”¨python >= 3.10**

è¿è¡Œä»¥ä¸‹gitå‘½ä»¤å…‹éš†ä»“åº“å¹¶åˆå§‹åŒ–å­æ¨¡å—
```shell
git clone https://github.com/WSH032/sd-webui-fast-dataset-maker.git --recurse-submodules
```
å®‰è£…ä¾èµ–
- Windowç”¨æˆ·å¯ä»¥è¿è¡Œ `install.ps1` å®‰è£…ä¾èµ–
- Linuxç”¨æˆ·è¯·è‡ªè¡Œé€šè¿‡ `pip install -r requirements.txt` å®‰è£…ä¾èµ–

```
å¯¹äºé€šè¿‡ `requirements.txt` å®‰è£…çš„ç”¨æˆ·è¯·æ³¨æ„
å¦‚æœä½ åœ¨ä½¿ç”¨WD14ç”Ÿæˆtagçš„æ—¶å€™æƒ³ä½¿ç”¨GPUåŠ é€Ÿ
è¯·æ‰“å¼€ `requirements.txt` ä¿®æ”¹å®‰è£… torch=2.0.0 + cuda118

# If you want to install with CUDA, please use the following command:

# --extra-index-url https://download.pytorch.org/whl/cu118
# torch==2.0.0+cu118
# torchvision==0.15.1+cu118
```
#### æ³¨æ„
> æ­¤WebUIä½¿ç”¨äº†Gradioéå®˜æ–¹æ–‡æ¡£çš„æ“ä½œæ–¹æ³•ï¼Œå¹¶åœ¨ `gradio <=3.35.2, >=3.29.0` è¿›è¡Œäº†æµ‹è¯•ï¼Œä½†ä¸ä¿è¯æœªæ¥Gradioå®˜æ–¹ä¸ä¼šä¿®æ”¹ç›¸åº”æ¥å£
>
> `requirements.txt` å†…åªè¦æ±‚äº† `gradio >= 3.31.0` ï¼Œå¦‚æœå‡ºç°é—®é¢˜è¯·å°è¯•é™çº§è‡³ `gradio <=3.35.2, >=3.31.0`
>
> æˆ–è€…ä½¿ç”¨ `requirements_versions.txt` å®‰è£…ä¾èµ–


### ï¼ˆä¸‰ï¼‰åšä¸º[AUTOMATIC1111/stable-diffusion-webui](https://github.com/AUTOMATIC1111/stable-diffusion-webui)çš„æ‰©å±•ä½¿ç”¨
è¯·å‚é˜…åŸä½œè€…å„è‡ªçš„ä»“åº“ï¼Œå‡ ä¹æ‰€æœ‰æ‰©å±•å‡å¯åšä¸º SD-WebUI çš„æ‰©å±•ä½¿ç”¨
- [zanllp/sd-webui-infinite-image-browsing](https://github.com/zanllp/sd-webui-infinite-image-browsing)
- [WSH032/Gelbooru-API-Downloader](https://github.com/WSH032/Gelbooru-API-Downloader)
- [WSH032/image-deduplicate-cluster-webui](https://github.com/WSH032/image-deduplicate-cluster-webui)
- [toshiaki1729/dataset-tag-editor-standalone](https://github.com/toshiaki1729/dataset-tag-editor-standalone)

![A1111-SD-WebUI](https://github.com/WSH032/sd-webui-fast-dataset-maker/assets/126865849/63caea91-42ce-4be5-b3c7-90ddaff17487)


## éƒ¨ç½²ä½¿ç”¨ - ä½¿ç”¨æ–¹æ³•

Please refer to the original author's repository for the specific usage of each extension

å„æ’ä»¶å…·ä½“çš„ä½¿ç”¨æ–¹æ³•è¯·æŸ¥çœ‹åŸä½œè€…ä»“åº“è‡ªè¿°æ–‡ä»¶ï¼Œè¿™é‡Œä¸å†é‡å¤

### ï¼ˆä¸€ï¼‰ æ–°æ‰‹ è¯·è¿è¡Œ `run_webui.ps1`

### ï¼ˆäºŒï¼‰ è¿›é˜¶ Shellä¸­è¿è¡Œå¹¶è®¾ç½®å‚æ•°
```shell
python webui.py # ä½¿ç”¨ `--help` æŸ¥çœ‹å¯é€‰å‚æ•°

# ä¾‹å¦‚
# python webui.py --sd_webui_config="config.json" --update_image_index --inbrowser

```

### ï¼ˆä¸‰ï¼‰ Python API æ¥å£

è¯·å‚é˜… Colab ç¤ºä¾‹ æˆ–è€… `run_webui.ipynb`


```python
from webui import WebuiUtils

# params for extension
# ä¸ºå„æ‰©å±•è®¾ç½®å‚æ•°ï¼Œå…·ä½“å‚æ•°è¯·å‚é˜… `extensions/extensions_preload.py`
# æˆ–è€…è¿è¡Œ `WebuiUtils(help=True)` æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
# Pyhton æ¥å£å‚æ•° ä¸ å‘½ä»¤è¡Œå‚æ•°ä¸€è‡´
webui_utils = WebuiUtils(

    # for image_browsing setting
    sd_webui_config = "config.json",
    extra_paths = ["path"],
    update_image_index = True,
    
    # disable extension
    disable_image_browsing = False,
    disable_deduplicate_cluster = False,
    disable_tag_editor = False,
)

"""
The args of `queue()` and `launch()` are the same as `gradio.Blocks.queue()` and `gradio.Blocks.launch()`

æ¥ä¸‹æ¥æŠŠå®ƒå½“æˆ `gradio.Blocks` ä½¿ç”¨å°±å¥½ï¼Œæ‰€æœ‰æ¥å£ä¸ `gradio.Blocks` ä¸€è‡´
"""
webui_utils.queue(concurrency_count=2)  # equal to `gradio.Blocks.queue(concurrency_count=2)`

webui_utils.launch(debug=True, server_port=7860)  # equal to `gradio.Blocks.launch(debug=True, server_port=7860)`

```
